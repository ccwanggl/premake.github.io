<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Premake Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Premake Blog Atom Feed"><title data-react-helmet="true">Generating Project Files | Premake</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Generating Project Files | Premake"><meta data-react-helmet="true" name="description" content="Now let&#x27;s extend our new action to actually output some workspace and project files so we can begin to get a sense for how things work."><meta data-react-helmet="true" property="og:description" content="Now let&#x27;s extend our new action to actually output some workspace and project files so we can begin to get a sense for how things work."><meta data-react-helmet="true" property="og:url" content="https://premake.github.io//docs/Generating-Project-Files"><link data-react-helmet="true" rel="shortcut icon" href="/img/premake-logo.png"><link data-react-helmet="true" rel="canonical" href="https://premake.github.io//docs/Generating-Project-Files"><link rel="stylesheet" href="/styles.c068bf60.css">
<link rel="preload" href="/styles.405de12c.js" as="script">
<link rel="preload" href="/runtime~main.2098b754.js" as="script">
<link rel="preload" href="/main.d2ee54d9.js" as="script">
<link rel="preload" href="/1.b9049073.js" as="script">
<link rel="preload" href="/2.f678ca8e.js" as="script">
<link rel="preload" href="/347.79f48d1b.js" as="script">
<link rel="preload" href="/348.0ea35abf.js" as="script">
<link rel="preload" href="/935f2afb.6aa9cc90.js" as="script">
<link rel="preload" href="/17896441.e8291e61.js" as="script">
<link rel="preload" href="/ee24cd1f.19ce91d5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/premake-logo.png" alt="Premake Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/premake-logo.png" alt="Premake Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Premake</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/download">Download</a><a class="navbar__item navbar__link" href="/community/support">Community</a><a href="https://github.com/premake/premake-core" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/premake-logo.png" alt="Premake Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/premake-logo.png" alt="Premake Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Premake</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/download">Download</a></li><li class="menu__list-item"><a class="menu__link" href="/community/support">Community</a></li><li class="menu__list-item"><a href="https://github.com/premake/premake-core" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Generating Project Files</h1></header><div class="markdown"><p>Now let&#x27;s extend our new action to actually output some workspace and project files so we can begin to get a sense for how things work.</p><p>First we need to know what we want to generate. Let&#x27;s start with a very simple Premake project script, then we&#x27;ll figure out how we want it to appear when we translate it to Lua.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">workspace &quot;Greetings&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    configurations { &quot;Debug&quot;, &quot;Release&quot; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">project &quot;HelloApp&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    kind &quot;ConsoleApp&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    language &quot;C++&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    files { &quot;hello.h&quot;, &quot;hello.cpp&quot; }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>There are, of course, many ways we could express this in Lua. For the purposes of this tutorial, we&#x27;ll start by creating two files, starting with <code>Greetings.wks.lua</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">workspace = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name = &quot;Greetings&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    projects = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [&quot;HelloApp&quot;] = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            path = &quot;HelloApp.prj.lua&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Workspaces generally are used to manage a list of projects, so we&#x27;ll try to do the same with our Lua version.</p><p>We&#x27;ll also generate a second file named <code>HelloApp.prj.lua</code>, containing some of the easily accessible project information.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">project = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name = &quot;MyConsoleApp&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uuid = &quot;B19F86AA-524E-4260-B200-243C70F2DA04&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    kind = &quot;ConsoleApp&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    language = &quot;C++&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This is just to get things started; we&#x27;ll come back to the configurations and the source code files and all of the other settings later.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="creating-the-files"></a>Creating the Files<a class="hash-link" href="#creating-the-files" title="Direct link to heading">#</a></h2><p>Creating these files is easy: Premake has a built-in function to do just that, which we can leverage in our action&#x27;s <code>onWorkspace()</code> and <code>onProject()</code> callbacks.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- lua/lua.lua</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">premake.modules.lua = {}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">local m = premake.modules.lua</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">local p = premake</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">newaction {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    trigger = &quot;lua&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    description = &quot;Export project information as Lua&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    onStart = function ()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -- create a new file with a &quot;.wks.lua&quot; extension and</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -- then call our generateWorkspace() function.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    onWorkspace = function(wks)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        p.generate(wks, &quot;.wks.lua&quot;, m.generateWorkspace)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -- create a new file with a &quot;.prj.lua&quot; extension and</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -- then call our generateProject() function.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    onProject = function(prj)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        p.generate(prj, &quot;.prj.lua&quot;, m.generateProject)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function m.generateWorkspace(wks)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.w(&#x27;This is a Lua &quot;workspace&quot; file.&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function m.generateProject(prj)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.w(&#x27;This is a Lua &quot;project&quot; file.&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">return m</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The <code>premake.generate()</code> function uses the information contained in the workspace or project to figure out the right name of location for the file, and then creates it on the disk. Once the file has been successfully created and opened, it then calls the function we provide as the last argument in the call (<code>generateWorkspace()</code> and <code>generateProject()</code> respectively) and passes it the corresponding workspace or project object to be exported.</p><p>The <code>p.w()</code> function, which stands for &quot;Premake write&quot;, simply outputs a text string to the currently open file. You&#x27;ll be seeing much more of this one.</p><p>If you go ahead and generate that project (i.e. run <code>premake5 lua</code> again), you will see the files get created on disk, each containing the corresponding &quot;This is a...&quot; message.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="populating-the-workspace"></a>Populating the Workspace<a class="hash-link" href="#populating-the-workspace" title="Direct link to heading">#</a></h2><p>Now we can begin to fill in our workspace and project files. Let&#x27;s begin with the easy parts of the workspace.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function m.generateWorkspace(wks)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.push(&#x27;workspace = {&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.w(&#x27;name = &quot;%s&quot;,&#x27;, wks.name)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.push(&#x27;projects = {&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.pop(&#x27;},&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.pop(&#x27;}&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>A couple of new functions here: <code>p.push()</code> writes the provided string to the output file, and increments an internal indentation level. <code>p.pop()</code> decrements the indentation level, and then writes its provided string to the output. <code>p.w()</code>, which we saw earlier, outputs its string at the current indentation level as set by <code>push()</code> and <code>pop()</code>.</p><p>So between all that pushing and popping, we end up with a nicely indented workspace file with an empty list of projects.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">workspace = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name = &quot;Greetings&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    projects = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Let&#x27;s tackle that project list next. Premake has an entire API for working with workspaces, which you can find by browsing the <a href="https://github.com/premake/premake-core/blob/master/src/base/workspace.lua" target="_blank" rel="noopener noreferrer">src/base/workspace.lua</a> script in Premake&#x27;s source code.</p><p><em>(Coming soon, just need to make a few code changes...)</em></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="populating-the-project"></a>Populating the Project<a class="hash-link" href="#populating-the-project" title="Direct link to heading">#</a></h2><p>Since we&#x27;re only exporting a few of the simple fields, generating our project file is quite easy:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function m.generateProject(prj)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.push(&#x27;project = {&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.w(&#x27;name = &quot;%s&quot;,&#x27;, prj.name)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.w(&#x27;uuid = &quot;%s&quot;,&#x27;, prj.uuid)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.w(&#x27;kind = &quot;%s&quot;&#x27;, prj.kind)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.pop(&#x27;}&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Which gives us a project file like:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">project = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name = &quot;MyConsoleApp&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uuid = &quot;B19F86AA-524E-4260-B200-243C70F2DA04&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    kind = &quot;ConsoleApp&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    language = &quot;C++&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="escapes-and-indents-and-eols"></a>Escapes and Indents and EOLs<a class="hash-link" href="#escapes-and-indents-and-eols" title="Direct link to heading">#</a></h2><p>For the sake of completeness, a few last points.</p><p>First, indentation. By default, Premake will uses tab characters to indent the output. If your target format uses a different character sequence, two spaces for instances, you can adjust that using Premake&#x27;s <code>p.indent()</code> function.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">p.indent(&quot;  &quot;)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Similarly, Premake will output Unix-style &quot;\n&quot; line endings by default, which can be changed with the <code>p.eol()</code> function.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">p.eol(&quot;\r\n&quot;)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>If you wish to change these values for both your generated workspaces and projects, you can place them in your action&#x27;s <code>onStart()</code> function. If the values are different between workspaces and projects, put then in <code>onWorkspace()</code> and <code>onProject()</code> instead.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">onStart = function()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.indent(&quot;  &quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.eol(&quot;\r\n&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Finally, before we go we should consider string escaping. If, for example, someone were to name their project <code>Joe&#x27;s &quot;Lucky&quot; Diner</code>, we would try to generate this Lua script...</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name = &quot;Joe&#x27;s &quot;Lucky&quot; Diner&quot;,</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>...which would fail to load in a Lua interpreter, since the double quotes aren&#x27;t properly matched. Instead, we ought to be generating:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name = &quot;Joe&#x27;s \&quot;Lucky\&quot; Diner&quot;,</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Premake allows exporters to define an &quot;escaper&quot;, a function which is used to transform values before they are written to the output. For our Lua exporter, we want to escape those double quotes with a backslash, and we should also escape backslashes while we&#x27;re at it, which we can do by adding this function to our module:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function m.esc(value)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    value = value:gsub(&#x27;\\&#x27;, &#x27;\\\\&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    value = value:gsub(&#x27;&quot;&#x27;, &#x27;\\&quot;&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>We can then tell Premake to use this function for both our workspaces and our project by registering our escaper in our action&#x27;s <code>onStart()</code>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">onStart = function()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.escaper(m.escaper)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>One more step: since we don&#x27;t <em>always</em> want to escape values, Premake provides a separate call <code>p.x()</code> for those times when we do. For our example case, we really only need to worry about the workspace and solution names right now, since the other fields are limited to values which do not contain special characters (while there is no harm in using <code>p.x()</code> on values that do not contain special characters, there is a small performance hit which can add up for large projects).</p><p>So our final script looks like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lua codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- lua/lua.lua</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">premake.modules.lua = {}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">local m = premake.modules.lua</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">local p = premake</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">newaction {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    trigger = &quot;lua&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    description = &quot;Export project information as Lua&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    onStart = function ()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        p.escaper(m.esc)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    onWorkspace = function(wks)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        p.generate(wks, &quot;.wks.lua&quot;, m.generateWorkspace)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    onProject = function(prj)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        p.generate(prj, &quot;.prj.lua&quot;, m.generateProject)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function m.generateWorkspace(wks)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.push(&#x27;workspace = {&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.x(&#x27;name = &quot;%s&quot;,&#x27;, wks.name)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.push(&#x27;projects = {&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.pop(&#x27;},&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.pop(&#x27;}&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function m.generateProject(prj)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.push(&#x27;project = {&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.x(&#x27;name = &quot;%s&quot;,&#x27;, prj.name)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.w(&#x27;uuid = &quot;%s&quot;,&#x27;, prj.uuid)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.w(&#x27;kind = &quot;%s&quot;&#x27;, prj.kind)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    p.pop(&#x27;}&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function m.esc(value)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    value = value:gsub(&#x27;\\&#x27;, &#x27;\\\\&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    value = value:gsub(&#x27;&quot;&#x27;, &#x27;\\&quot;&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">return m</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/premake/premake-core/edit/master/website/docs/Generating-Project-Files.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-03-30T13:07:59.000Z" class="docLastUpdatedAt_1Qna">3/30/2021</time> by <strong>starkos</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-the-files" class="table-of-contents__link">Creating the Files</a></li><li><a href="#populating-the-workspace" class="table-of-contents__link">Populating the Workspace</a></li><li><a href="#populating-the-project" class="table-of-contents__link">Populating the Project</a></li><li><a href="#escapes-and-indents-and-eols" class="table-of-contents__link">Escapes and Indents and EOLs</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Documentation</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Premake 5.0</a></li><li class="footer__item"><a href="https://github.com/premake/premake-4.x/wiki" target="_blank" rel="noopener noreferrer" class="footer__link-item">Premake 4.x</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/premake" target="_blank" rel="noopener noreferrer" class="footer__link-item">StackOverflow</a></li><li class="footer__item"><a href="https://twitter.com/premakeapp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a class="footer__link-item" href="/community/support">Help</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/premake/premake-core/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Premake</div></div></div></footer></div>
<script src="/styles.405de12c.js"></script>
<script src="/runtime~main.2098b754.js"></script>
<script src="/main.d2ee54d9.js"></script>
<script src="/1.b9049073.js"></script>
<script src="/2.f678ca8e.js"></script>
<script src="/347.79f48d1b.js"></script>
<script src="/348.0ea35abf.js"></script>
<script src="/935f2afb.6aa9cc90.js"></script>
<script src="/17896441.e8291e61.js"></script>
<script src="/ee24cd1f.19ce91d5.js"></script>
</body>
</html>