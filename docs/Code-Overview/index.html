<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Premake Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Premake Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Premake" href="/opensearch.xml">
<script src="https://use.fontawesome.com/dd1c9cd9ff.js"></script><title data-react-helmet="true">Code Overview | Premake</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://premake.github.io//docs/Code-Overview"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Code Overview | Premake"><meta data-react-helmet="true" name="description" content="A Quick Tour of Premake ##"><meta data-react-helmet="true" property="og:description" content="A Quick Tour of Premake ##"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://premake.github.io//docs/Code-Overview"><link data-react-helmet="true" rel="alternate" href="https://premake.github.io//docs/Code-Overview" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://premake.github.io//docs/Code-Overview" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.47f1bab1.css">
<link rel="preload" href="/assets/js/runtime~main.7d6e4514.js" as="script">
<link rel="preload" href="/assets/js/main.c628248a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/premake-logo.png" alt="Premake Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/premake-logo.png" alt="Premake Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Premake</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/blog">News</a><a class="navbar__item navbar__link" href="/community/support">Community</a></div><div class="navbar__items navbar__items--right"><a href="https://twitter.com/premakeapp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link fa fa-twitter fa-2x" aria-label="Premake on Twitter"></a><a href="https://github.com/premake/premake-core" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link fa fa-github fa-2x" aria-label="GitHub repository"></a><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_NKBi"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Writing Premake Scripts</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Extending Premake</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Extending-Premake">Extending Premake</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Code-Overview">Code Overview</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Coding-Conventions">Coding Conventions</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Overrides-and-Call-Arrays">Overrides &amp; Call Arrays</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Developing-Modules">Developing Modules</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Adding-New-Action">Adding a New Action</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Guides</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Code Overview</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="a-quick-tour-of-premake"></a>A Quick Tour of Premake<a class="hash-link" href="#a-quick-tour-of-premake" title="Direct link to heading">#</a></h2><p>The Premake source code is organized into a few different folders:</p><ul><li><p><code>src/actions</code> contains the code for the built-on actions and exporters, e.g. &quot;vs2012&quot; or &quot;gmake&quot;. We are gradually migrating these into independent modules, but for now they live here.</p></li><li><p><code>src/base</code> contains the core Lua scripts, the code that is used to read and process your project scripts, and supporting logic for the actions and exporters.</p></li><li><p><code>src/host</code> contains all of the C language code, logic that either can&#x27;t easily be written in Lua because of the way it needs to interact with the underlying operating system, or because a Lua implementation would be too slow. We try to keep C code to a minimum and use Lua whenever we can, to enable <a href="/docs/Overrides-and-Call-Arrays">overrides and call arrays</a>.</p></li><li><p><code>src/tools</code> contains the adapters for command line toolsets like GCC and Clang. We will probably be migrating these toward modules in the near-ish future as well.</p></li><li><p><code>modules</code> contains the official set of modules which are distributed as part of Premake. These modules add support for additional languages and toolsets to the core code in the <code>src</code> folder.</p></li></ul><p>In addition to those general categories, there are a few special files of note:</p><ul><li><p><code>src/_premake_main.lua</code> contains the Lua-side program entry point, and is responsible for the main application flow. The C-side program entry point <code>main()</code> is located in <code>src/host/premake_main.c</code>.</p></li><li><p><code>src/_premake_init.lua</code> sets up much of the initial configuration, including all of the project scripting functions, the default set of command line arguments, and the default project configurations.</p></li><li><p><code>src/_modules.lua</code> contains the list of built-in modules which are automatically loaded in startup. See <a href="/docs/Embedding-Modules">Embedding Modules</a> for more information.</p></li><li><p><code>src/_manifest.lua</code> lists the Lua scripts that should be embedded into the Premake executable when making the release builds. There are separate manifests for Premake&#x27;s core scripts and each embedded module.</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="code-execution-overview"></a>Code Execution Overview<a class="hash-link" href="#code-execution-overview" title="Direct link to heading">#</a></h2><p>Execution starts at <code>main()</code> in <code>src/host/premake_main.c</code>, which calls into to <code>src/host/premake.c</code> to do the real bootstrapping work:</p><ul><li><p><code>premake_init()</code> installs all of Premake&#x27;s native C extensions to the Lua scripting environment.</p></li><li><p><code>premake_execute()</code> finds and runs <code>src/_premake_main.lua</code>, which may be embedded into the executable for a release build, or located on the filesystem.</p></li><li><p><code>src/_premake_main.lua</code> in turn reads <code>src/_manifest.lua</code> and loads all of the scripts listed there. Notably, this includes <code>src/_premake_init.lua</code> which does</p></li><li><p>Once <code>src/premake_main.lua</code> has finished, <code>premake_execute()</code> calls <code>_premake_main()</code>, which located at the end of <code>src/_premake_main.lua</code>, and waits for it to return.</p></li></ul><p>At this point, execution has moved into and remains in Lua; <a href="/docs/Overrides-and-Call-Arrays">extending Premake by overriding functions and call arrays</a> now becomes possible.</p><p><code>_premake_main()</code> uses a <a href="/docs/Overrides-and-Call-Arrays">call array</a> to control the high-level process of evaluating the user scripts and acting on the results. Notable functions in this list include:</p><ul><li><p><code>prepareEnvironment()</code> sets more global variables and otherwise gets the script environment ready to use.</p></li><li><p><code>locateUserScript()</code> handles finding the user&#x27;s project script, i.e. <code>premake5.lua</code> on the file system.</p></li><li><p><code>checkInteractive()</code> is responsible for launching the REPL prompt, if requested.</p></li><li><p><code>runSystemScript()</code> runs <a href="/docs/System-Scripts">the user&#x27;s system script</a>, and <code>runUserScript()</code> runs the project script found by <code>locateUserScript()</code>.</p></li><li><p><code>processCommandLine()</code> handles any command line options and sets the target action and arguments. This needs to happen after the project script has run, in case it defines new options or modifies the behavior of existing optionsâ€”a common point of confusion.</p></li><li><p><code>bake()</code> takes all of the project and configuration information that has been specified in the user&#x27;s project script and prepares it for use by the target action, a somewhat convoluted process that is implemented in <code>src/base/oven.lua</code>.</p></li><li><p><code>validate()</code> examines the processed configuration information and tries to make sure it all makes sense, and that all required data is available. The main validation logic is located in <code>src/base/validation.lua</code>.</p></li><li><p><code>callAction()</code> passes each workspace, project, rule, and other container to the target action, causing the appropriate result--like generating a Visual Studio project or GNU makefile--to occur. This container iteration is done in <code>action.call()</code> in <code>src/base/action.lua</code>.</p></li></ul><p>Calling the action, via <code>callAction()</code>, is where the interesting part for most people begins. Control now transfers to one of exporters, causing the project files to be written. For more information on how <em>that</em> happens, see <a href="/docs/Adding-New-Action">Creating a New Action</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/premake/premake-core/edit/master/website/docs/Code-Overview.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated on <b><time datetime="2021-06-01T21:24:42.000Z">6/1/2021</time></b> by <b>KyrietS</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/Extending-Premake"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Extending Premake</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/Coding-Conventions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Coding Conventions Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#a-quick-tour-of-premake" class="table-of-contents__link">A Quick Tour of Premake</a></li><li><a href="#code-execution-overview" class="table-of-contents__link">Code Execution Overview</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/What-Is-Premake">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/download">Download</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/Your-First-Script">Your First Script</a></li><li class="footer__item"><a href="https://github.com/premake/premake-4.x/wiki" target="_blank" rel="noopener noreferrer" class="footer__link-item">Premake 4.x</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/premake/premake-core/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/premake" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/community/support">Help</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/premake/premake-core/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/premakeapp" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opencollective.com/premake" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>OpenCollective<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Premake</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7d6e4514.js"></script>
<script src="/assets/js/main.c628248a.js"></script>
</body>
</html>